<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>HDU 4945 2048 | World of Forks</title>
  <meta name="description" content="{{theme.description}}" />
  <meta name="keywords" content="{{theme.keywords}}" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Time Limit: 3000/1500 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)Total Submission(s): 590    Accepted Submission(s): 136
Problem Description


Teacher Mai is addicted to game 2048. B">
<meta property="og:type" content="article">
<meta property="og:title" content="HDU 4945 2048">
<meta property="og:url" content="http://kntan.coding.me/2014/08/15/hdu-4945-2048/index.html">
<meta property="og:site_name" content="World of Forks">
<meta property="og:description" content="Time Limit: 3000/1500 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)Total Submission(s): 590    Accepted Submission(s): 136
Problem Description


Teacher Mai is addicted to game 2048. B">
<meta property="og:updated_time" content="2015-02-26T02:47:19.640Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HDU 4945 2048">
<meta name="twitter:description" content="Time Limit: 3000/1500 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)Total Submission(s): 590    Accepted Submission(s): 136
Problem Description


Teacher Mai is addicted to game 2048. B">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
		<div class="wrapper container">
			<a class="logo flat-box" href="/">
				World of Forks
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu"></span></a></li>
			</ul>
		</div>
		<aside class="menu-phone">
			<nav>
				
					<a href="/" class="nav-home nav">
						Home
					</a>
				
					<a href="/archives" class="nav-archives nav">
						Archives
					</a>
				
					<a href="/about" class="nav-about nav">
						About
					</a>
				
			</nav>
		</aside>
</header>



    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container'>
      <div class='l_main'>
        <article id="post-hdu-4945-2048"
  class="post article white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title">
  	<a href="/2014/08/15/hdu-4945-2048/">
    	HDU 4945 2048
    </a>
  </h2>
	<time>
	  8月 15, 2014
	</time>
	
    
    <div class='cats'>
        <a href="/categories/ACM/">ACM</a>
    </div>

	</section>
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<p><strong><span style="font-family: Arial; font-size: 12px; font-weight: bold; color: green;">Time Limit: 3000/1500 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 590    Accepted Submission(s): 136<br></span></strong></p>
<p><div class="panel_title" align="left">Problem Description</div></p>
<div class="panel_content">

<p>Teacher Mai is addicted to game 2048. But finally he finds it’s too hard to get 2048. So he wants to change the rule:</p>
<p>You are given some numbers. Every time you can choose two numbers of the same value from them and merge these two numbers into their sum. And these two numbers disappear meanwhile.</p>
<p>If we can get 2048 from a set of numbers with this operation, Teacher Mai think this multiset is good.</p>
<p>You have n numbers, A<sub>1</sub>,…,A<sub>n</sub>. Teacher Mai ask you how many subsequences of A are good.</p>
<p>The number can be very large, just output the number modulo 998244353.<br><a id="more"></a><br></p></div><p></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Input</div></p>
<div class="panel_content">

<p>There are multiple test cases, terminated by a line “0”.</p>
<p>For each test case, the first line contains an integer n (1&lt;=n&lt;=10^5), the next line contains n integers a<sub>i</sub> (0&lt;=a<sub>i</sub>&lt;=2048).</p>
<p></p></div><p></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Output</div></p>
<p><div class="panel_content">For each test case, output one line “Case #k: ans”, where k is the case number counting from 1, ans is the number module 998244353.</div></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Sample Input</div></p>
<p><div class="panel_content"></div></p>
<p><div style="font-family: Courier New,Courier,monospace;">4 1024 512 256 256 4 1024 1024 1024 1024 5 1024 512 512 512 1 0</div><br></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Sample Output</div></p>
<p><div class="panel_content"></div></p>
<div style="font-family: Courier New,Courier,monospace;">

<p>Case #1: 1 Case #2: 11 Case #3: 8</p>
<p><div style="font-family: Times New Roman; font-size: 14px; background-color: f4fbff; border: #B7CBFF 1px dashed; padding: 6px;"></div></p>
<p><div style="font-family: Arial; font-weight: bold; color: #7ca9ed; border-bottom: #B7CBFF 1px dashed;"><em>Hint</em></div><br>In the first case, we should choose all the numbers. In the second case, all the subsequences which contain more than one number are good.</p>
<p></p></div><br>&nbsp;<p></p>
<p><br></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Source</div></p>
<p><div class="panel_content"><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014%20Multi-University%20Training%20Contest%208&amp;source=1&amp;searchmode=source" target="_blank" rel="external"> 2014 Multi-University Training Contest 8 </a></div></p>
<p><div class="panel_bottom"></div><br>&nbsp;</p>
<p><div class="panel_title" align="left">Recommend</div></p>
<p><div class="panel_content">hujie   |   We have carefully selected several similar problems for you:  <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4955" target="_blank" rel="external">4955</a> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4954" target="_blank" rel="external">4954</a> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4953" target="_blank" rel="external">4953</a> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4952" target="_blank" rel="external">4952</a> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4951" target="_blank" rel="external">4951</a></div><br><br></p>
<hr>
<p><div class="panel_content">貌似这几天第一次做的DP题啊。想象一下二进制就能明白——当子序列的2次幂数字之和大于等于2048时这个序列就是good序列了。正面dp要dp出2048~100000肯定要超时，而反面dp只需要dp出0~2047就够了。复杂度大大降低O（11＊2048*2048）。</div></p>
<p><div class="panel_content">标程写的很厉害！尤其是逆元的处理！</div><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;map&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;set&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;cmath&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;stack&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;queue&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;string&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;cstdio&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;vector&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;cctype&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;cassert&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;utility&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;numeric&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;cstring&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;iostream&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span>&amp;lt;algorithm&amp;gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pr pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PR pair&amp;lt;int,int&amp;gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MP make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SI(x) set&amp;lt;x&amp;gt;::iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> VI(x) vector&amp;lt;x&amp;gt;::iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MI(x,y) map&amp;lt;x,y&amp;gt;::iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SRI(x) set&amp;lt;x&amp;gt;::reverse_iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> VRI(x) vector&amp;lt;x&amp;gt;::reverse_iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MRI(x,y) map&amp;lt;x,y&amp;gt;::reverse_iterator</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> F first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> S second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Sz(x) (int)x.size()</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clrQ(x) while(!x.empty)x.pop();</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x,y) memset(x,y,sizeof(x));</span></div><div class="line"><span class="meta">#<span class="meta-keyword">if</span> defined (_WIN32) || defined (__WIN32) || defined (WIN32) || defined (__WIN32__)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL __int64</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LLS <span class="meta-string">"%"</span> <span class="meta-string">"I"</span> <span class="meta-string">"6"</span> <span class="meta-string">"4"</span> <span class="meta-string">"d"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LLU <span class="meta-string">"%"</span> <span class="meta-string">"I"</span> <span class="meta-string">"6"</span> <span class="meta-string">"4"</span> <span class="meta-string">"u"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL_MAX _I64_MAX</span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LLS <span class="meta-string">"%"</span> <span class="meta-string">"l"</span> <span class="meta-string">"l"</span> <span class="meta-string">"d"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LLU <span class="meta-string">"%"</span> <span class="meta-string">"l"</span> <span class="meta-string">"l"</span> <span class="meta-string">"u"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL_MAX _I64_MAX</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = ~<span class="number">0u</span> &amp;gt;&amp;gt; <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> LL lnf = ~<span class="number">0u</span>ll &amp;gt;&amp;gt; <span class="number">1</span>;</div><div class="line"><span class="comment">/*start*/</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 998244353</span></div><div class="line"><span class="keyword">int</span> cnt[<span class="number">3010</span>];</div><div class="line">LL f[<span class="number">101000</span>], g[<span class="number">101000</span>];</div><div class="line"><span class="keyword">int</span> pn, n, <span class="number">__</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">13</span>][<span class="number">1025</span>]; <span class="comment">//表示取了2^0、2^1、2^2、……、2^i种元素，总和加起来等于j*2^(i+1)的所有情况</span></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getint</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">    <span class="keyword">bool</span> ok = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">        <span class="keyword">int</span> c = getchar();</div><div class="line">        <span class="keyword">if</span> (c &amp;gt;= <span class="string">'0'</span> &amp;amp;&amp;amp; c &amp;lt;= <span class="string">'9'</span>) ret = (ret &amp;lt;&amp;lt; <span class="number">3</span>) + ret + ret + c - <span class="string">'0'</span>, ok = <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ok) <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">powmod</span><span class="params">(LL b, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    LL res = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (b %= MOD; x; x &amp;gt;&amp;gt;= <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (x &amp;amp; <span class="number">1</span>) res = res * b % MOD;</div><div class="line">        b = b * b % MOD;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</div><div class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &amp;lt;= <span class="number">100000</span>; i++)</div><div class="line">        f[i] = f[i - <span class="number">1</span>] * i % MOD;</div><div class="line">    g[<span class="number">100000</span>] = powmod(f[<span class="number">100000</span>], MOD - <span class="number">2</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">99999</span>; i &amp;gt;= <span class="number">0</span>; i--)</div><div class="line">        g[i] = g[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</div><div class="line">        n = getint();</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &amp;lt;= <span class="number">2048</span>; k &amp;lt;&amp;lt;= <span class="number">1</span>)</div><div class="line">            cnt[k] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &amp;lt; n; i++) &#123;</div><div class="line">            cnt[getint()]++;</div><div class="line">        &#125;</div><div class="line">        pn = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &amp;lt;= <span class="number">2048</span>; k &amp;lt;&amp;lt;= <span class="number">1</span>)</div><div class="line">            pn += cnt[k];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, m = <span class="number">1024</span>; i &amp;lt;= <span class="number">11</span>; i++, m &amp;gt;&amp;gt;= <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &amp;lt;= m; j++) &#123;</div><div class="line">                dp[i][j] = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> ct = cnt[<span class="number">1</span>];</div><div class="line">        LL cof = f[ct];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &amp;lt;= ct &amp;amp;&amp;amp; i &amp;lt; <span class="number">2048</span>; i++) &#123;</div><div class="line">            dp[<span class="number">0</span>][i &amp;gt;&amp;gt; <span class="number">1</span>] += g[ct - i] * g[i] % MOD;</div><div class="line">            <span class="keyword">if</span> (dp[<span class="number">0</span>][i &amp;gt;&amp;gt; <span class="number">1</span>] &amp;gt; MOD) dp[<span class="number">0</span>][i &amp;gt;&amp;gt; <span class="number">1</span>] -= MOD;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, m = <span class="number">1024</span>; i &amp;lt;= <span class="number">11</span>; i++, m &amp;gt;&amp;gt;= <span class="number">1</span>) &#123;</div><div class="line">            ct = cnt[<span class="number">1</span> &amp;lt;&amp;lt; i];</div><div class="line">            cof = cof * f[ct] % MOD;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &amp;lt; m; j++) &#123; </div><div class="line">                <span class="keyword">if</span> (dp[i - <span class="number">1</span>][j]) &#123;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &amp;lt;= ct &amp;amp;&amp;amp; j + k &amp;lt; m; k++) &#123;<span class="comment">//不要把满足good的序列转移上去。</span></div><div class="line">                        dp[i][(j + k) &amp;gt;&amp;gt; <span class="number">1</span>] += dp[i - <span class="number">1</span>][j] * g[k] % MOD * g[ct - k] % MOD;</div><div class="line">                        <span class="keyword">if</span> (dp[i][(j + k) &amp;gt;&amp;gt; <span class="number">1</span>] &amp;gt; MOD) dp[i][(j + k) &amp;gt;&amp;gt; <span class="number">1</span>] -= MOD;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> ans = (powmod(<span class="number">2</span>, pn) - dp[<span class="number">11</span>][<span class="number">0</span>] * cof) % MOD</div><div class="line">                * powmod(<span class="number">2</span>, n - pn)%MOD;</div><div class="line">        <span class="keyword">if</span> (ans &amp;lt; <span class="number">0</span>) ans += MOD;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++<span class="number">__</span>, ans);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

  	</div>
	  
	  <div class="article-tags tags h-padding">
      
        <a href="/tags/DP/">DP</a>
      
	  </div>
    
	</section>
	
		<section id="comments">
			<div id="disqus_thread"></div>
		</section>
	
</article>

      </div>
      <aside class='l_side'>
        <section class='m_widget about'>
<img class='avatar waves-image' src='/images/avatar.jpg' />
<div class='header'>Kevinsfork</div>
<div class='content'>
<div id='hitokoto'></div>
</div>
</section>
<section class='m_widget friendly-links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://ccoooss.com">
            <div class='name'>老宋</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="http://frantic1048.logdown.com/">
            <div class='name'>Frantic1048</div>
        </a></li>
    
    </ul>
</div>
</section>
<section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/ACM/"><div class='name'>ACM</div><div class='badget'>20</div></a></li>
    
        <li><a class="flat-box" href="/categories/ASP-NET/"><div class='name'>ASP.NET</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Cloud-Computing/"><div class='name'>Cloud Computing</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/GFW/"><div class='name'>GFW</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Git/"><div class='name'>Git</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Hexo/"><div class='name'>Hexo</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/IDE-Editor/"><div class='name'>IDE/Editor</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/KDE/"><div class='name'>KDE</div><div class='badget'>3</div></a></li>
    
        <li><a class="flat-box" href="/categories/Python/"><div class='name'>Python</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/WM/"><div class='name'>WM</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Web/"><div class='name'>Web</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Wine/"><div class='name'>Wine</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Xfce/"><div class='name'>Xfce</div><div class='badget'>1</div></a></li>
    
    </ul>
    
</div>
</section>

<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <a href="/tags/C/" style="font-size: 15px; color: #6b6b6b">C#</a> <a href="/tags/DE-WM/" style="font-size: 17px; color: #404040">DE/WM</a> <a href="/tags/DP/" style="font-size: 14px; color: #808080">DP</a> <a href="/tags/LCA/" style="font-size: 16px; color: #555">LCA</a> <a href="/tags/RMQ/" style="font-size: 14px; color: #808080">RMQ</a> <a href="/tags/asp-net-mvc4/" style="font-size: 15px; color: #6b6b6b">asp.net mvc4</a> <a href="/tags/dom/" style="font-size: 14px; color: #808080">dom</a> <a href="/tags/github/" style="font-size: 14px; color: #808080">github</a> <a href="/tags/gtk/" style="font-size: 14px; color: #808080">gtk</a> <a href="/tags/html/" style="font-size: 17px; color: #404040">html</a> <a href="/tags/instantclick/" style="font-size: 14px; color: #808080">instantclick</a> <a href="/tags/javascirpt/" style="font-size: 14px; color: #808080">javascirpt</a> <a href="/tags/linux/" style="font-size: 19px; color: #151515">linux</a> <a href="/tags/neutron/" style="font-size: 14px; color: #808080">neutron</a> <a href="/tags/openstack/" style="font-size: 14px; color: #808080">openstack</a> <a href="/tags/python/" style="font-size: 14px; color: #808080">python</a> <a href="/tags/shadowsocks/" style="font-size: 14px; color: #808080">shadowsocks</a> <a href="/tags/simplemembership/" style="font-size: 14px; color: #808080">simplemembership</a> <a href="/tags/sublime-text/" style="font-size: 14px; color: #808080">sublime text</a> <a href="/tags/tarjan/" style="font-size: 18px; color: #2b2b2b">tarjan</a> <a href="/tags/倍增/" style="font-size: 14px; color: #808080">倍增</a> <a href="/tags/只言片语/" style="font-size: 17px; color: #404040">只言片语</a> <a href="/tags/图论/" style="font-size: 20px; color: #000">图论</a> <a href="/tags/数论/" style="font-size: 19px; color: #151515">数论</a> <a href="/tags/暴力/" style="font-size: 16px; color: #555">暴力</a> <a href="/tags/树形DP/" style="font-size: 14px; color: #808080">树形DP</a> <a href="/tags/树的直径/" style="font-size: 14px; color: #808080">树的直径</a> <a href="/tags/桌面/" style="font-size: 14px; color: #808080">桌面</a> <a href="/tags/矩阵-暴力/" style="font-size: 14px; color: #808080">矩阵,暴力</a> <a href="/tags/组合/" style="font-size: 14px; color: #808080">组合</a> <a href="/tags/网络流/" style="font-size: 14px; color: #808080">网络流</a> <a href="/tags/美化/" style="font-size: 18px; color: #2b2b2b">美化</a>
    </div>
</div>


      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/stkevintan" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/kevinclasky" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <span class="codename">MaterialFlow</span> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  <div>Mail: <a href="mailto:stkevintan@zju.edu.cn" title="stkevintan@zju.edu.cn">stkevintan@zju.edu.cn</a></div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  <script type="text/javascript" src="//api.i-meto.com/hitokoto?encode=js-html" async defer></script> 

<script>
  var disqus_shortname = 'kevinhome';
  
  var disqus_url = 'http://kntan.coding.me/2014/08/15/hdu-4945-2048/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
